

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Equilibrium data &mdash; phasepy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Pure component data" href="fit.pure.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> phasepy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../phasepy.html">phasepy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phasepy.equilibrium.html">phasepy.equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phasepy.sgt.html">phasepy.sgt</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../phasepy.fit.html">phasepy.fit</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fit.pure.html">Pure component data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Equilibrium data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fitting-qmr-mixing-rule">Fitting QMR mixing rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fitting-nrtl-parameters">Fitting NRTL parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fitting-wilson-s-model-parameters">Fitting Wilson’s model parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fitting-redlich-kister-interaction-parameters">Fitting Redlich-Kister interaction parameters</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">phasepy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../phasepy.fit.html">phasepy.fit</a> &raquo;</li>
        
      <li>Equilibrium data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/fit/fit.mixtures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="equilibrium-data">
<h1>Equilibrium data<a class="headerlink" href="#equilibrium-data" title="Permalink to this headline">¶</a></h1>
<p>Phasepy includes function to fit models for phase equilibria of binary mixtures, the fitted parameters by pairs can be used then with mixtures containing more components. Depending and model, there might be more of one type of phase equilibria. Suppose that the parameters model are represented by <span class="math notranslate nohighlight">\(\underline{\xi}\)</span>, the phasepy functions will fit the given experimental data with the followings objectives functions:</p>
<p>If there is Vapor-Liquid Equilibria (VLE):</p>
<div class="math notranslate nohighlight">
\[FO_{VLE}(\underline{\xi}) = \sum_{j=1}^{Np} \left[ \sum_{i=1}^c (y_{i,j}^{cal} - y_{i,j}^{exp})^2 + \left( \frac{P_{j}^{cal}}{P_{j}^{exp}} - 1\right)^2 \right]\]</div>
<p>If there is Liquid-Liquid Equilibria (LLE):</p>
<div class="math notranslate nohighlight">
\[FO_{LLE}(\underline{\xi}) = \sum_{j=1}^{Np} \sum_{i=1}^c  \left[(x_{i,j} - x_{i,j}^{exp})^2 +  (w_{i,j} - w_{i,j}^{exp})^2 \right]\]</div>
<p>If there is Vapor-Liquid-Liquid Equilibria (VLLE):</p>
<div class="math notranslate nohighlight">
\[FO_{VLLE}(\underline{\xi}) = \sum_{j=1}^{Np} \left[ \sum_{i=1}^c  \left[ (x_{i,j}^{cal} - x_{i,j}^{exp})^2 +  (w_{i,j}^{cal} - w_{i,j}^{exp})^2 +  (y_{i,j}^{cal} - y_{i,j}^{exp})^2 \right] + \left( \frac{P_{j}^{cal}}{P_{j}^{exp}} - 1\right)^2 \right]\]</div>
<p>If there is more than one type of phase equilibria, Phasepy will sum the errors of each one.
As an example the parameters for the system of ethanol and water will be fitted, first the experimental data has to be loaded and then set up as a tuple as if shown in the following code block.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Vapor Liquid equilibria data obtanied from Rieder, Robert M. y A. Ralph Thompson (1949).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Vapor-Liquid Equilibria Measured by a GillespieStill - Ethyl Alcohol - Water System.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Ind. Eng. Chem. 41.12, 2905-2908.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datavle</span> <span class="o">=</span> <span class="p">(</span><span class="n">Xexp</span><span class="p">,</span> <span class="n">Yexp</span><span class="p">,</span> <span class="n">Texp</span><span class="p">,</span> <span class="n">Pexp</span><span class="p">)</span>
</pre></div>
</div>
<p>If the system exhibits any other type phase equilibria the necessary tuples would have the following form:
&gt;&gt;&gt; datalle = (Xexp, Wexp, Texp, Pexp)
&gt;&gt;&gt; datavlle = (Xexp, Wexp, Yexp, Texp, Pexp)</p>
<p>Here, <code class="docutils literal notranslate"><span class="pre">Xexp</span></code>, <code class="docutils literal notranslate"><span class="pre">Wexp</span></code> and <code class="docutils literal notranslate"><span class="pre">Yexp</span></code> are experimental mole fraction for liquid, liquid and vapor phase, respectively. <code class="docutils literal notranslate"><span class="pre">Texp</span></code> and <code class="docutils literal notranslate"><span class="pre">Pexp</span></code> are experimental temperature and pressure, respectively.</p>
<p>After the experimental data is available, the mixture with the components is created.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">component</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="mf">647.13</span><span class="p">,</span> <span class="n">Pc</span> <span class="o">=</span> <span class="mf">220.55</span><span class="p">,</span> <span class="n">Zc</span> <span class="o">=</span> <span class="mf">0.229</span><span class="p">,</span>
<span class="gp">... </span><span class="n">Vc</span> <span class="o">=</span> <span class="mf">55.948</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">0.344861</span><span class="p">,</span> <span class="n">ksv</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.87292043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06844994</span><span class="p">],</span>
<span class="gp">... </span><span class="n">Ant</span> <span class="o">=</span>  <span class="p">[</span>  <span class="mf">11.72091059</span><span class="p">,</span> <span class="mf">3852.20302815</span><span class="p">,</span>  <span class="o">-</span><span class="mf">44.10441047</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ethanol</span> <span class="o">=</span> <span class="n">component</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Ethanol&#39;</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="mf">514.0</span><span class="p">,</span> <span class="n">Pc</span> <span class="o">=</span> <span class="mf">61.37</span><span class="p">,</span> <span class="n">Zc</span> <span class="o">=</span> <span class="mf">0.241</span><span class="p">,</span>
<span class="gp">... </span><span class="n">Vc</span> <span class="o">=</span> <span class="mf">168.0</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">0.643558</span><span class="p">,</span> <span class="n">ksv</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.27092923</span><span class="p">,</span> <span class="mf">0.0440421</span> <span class="p">],</span>
<span class="gp">... </span><span class="n">Ant</span> <span class="o">=</span> <span class="p">[</span>  <span class="mf">12.26474221</span><span class="p">,</span> <span class="mf">3851.89284329</span><span class="p">,</span>  <span class="o">-</span><span class="mf">36.99114863</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span> <span class="o">=</span> <span class="n">mixture</span><span class="p">(</span><span class="n">ethanol</span><span class="p">,</span> <span class="n">water</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="fitting-qmr-mixing-rule">
<h2>Fitting QMR mixing rule<a class="headerlink" href="#fitting-qmr-mixing-rule" title="Permalink to this headline">¶</a></h2>
<p>As an scalar is been fitted, SciPy recommends to give a certain interval where the minimum could be found, the function <code class="docutils literal notranslate"><span class="pre">fit_kij</span></code> handles this optimization as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">phasepy.fit</span> <span class="kn">import</span> <span class="n">fit_kij</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mixkij</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_kij</span><span class="p">((</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span> <span class="n">prsveos</span><span class="p">,</span> <span class="n">mixkij</span><span class="p">,</span> <span class="n">datavle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized kij value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="mf">0.10726854855665718</span>
</pre></div>
</div>
<span class="target" id="module-phasepy.fit.binaryfit"></span><dl class="py function">
<dt id="phasepy.fit.binaryfit.fit_kij">
<code class="sig-name descname">fit_kij</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kij_bounds</span></em>, <em class="sig-param"><span class="n">eos</span></em>, <em class="sig-param"><span class="n">mix</span></em>, <em class="sig-param"><span class="n">datavle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datalle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datavlle</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phasepy/fit/binaryfit.html#fit_kij"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#phasepy.fit.binaryfit.fit_kij" title="Permalink to this definition">¶</a></dt>
<dd><p>fit_kij: attemps to fit kij to LVE, LLE, LLVE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kij_bounds</strong> (<em>tuple</em>) – bounds for kij correction</p></li>
<li><p><strong>eos</strong> (<em>function</em>) – cubic eos to fit kij for qmr mixrule</p></li>
<li><p><strong>mix</strong> (<em>object</em>) – binary mixture</p></li>
<li><p><strong>datavle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Yexp, Texp, Pexp)</p></li>
<li><p><strong>datalle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Texp, Pexp)</p></li>
<li><p><strong>datavlle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Yexp, Texp, Pexp)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fit</strong> – Result of SciPy minimize</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>OptimizeResult</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="fitting-nrtl-parameters">
<h2>Fitting NRTL parameters<a class="headerlink" href="#fitting-nrtl-parameters" title="Permalink to this headline">¶</a></h2>
<p>As an array is been fitted, multidimentional optimization alogirthms are used, the function <code class="docutils literal notranslate"><span class="pre">fit_nrtl</span></code> handles this optimization with several options available. If a fixed value of the aleatory factor is used the initial guess has the following form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">A12</span><span class="p">,</span> <span class="n">A21</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">phasepy.fit</span> <span class="kn">import</span> <span class="n">fit_nrtl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mixnrtl</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initial guess of A12, A21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span>  <span class="mf">650.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_nrtl</span><span class="p">(</span><span class="n">nrtl0</span><span class="p">,</span> <span class="n">mixnrtl</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">alpha_fixed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mf">84.77530335</span><span class="p">,</span> <span class="mf">648.78439102</span><span class="p">]</span>
</pre></div>
</div>
<p>By default bubble points using activity coefficient models use Tsonopoulos virial correlation, if desired ideal gas or Abbott correlation can be used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">phasepy</span> <span class="kn">import</span> <span class="n">ideal_gas</span><span class="p">,</span> <span class="n">Abbott</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initial guess of A12, A21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span>  <span class="mf">650.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_nrtl</span><span class="p">(</span><span class="n">nrtl0</span><span class="p">,</span> <span class="n">mixnrtl</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">alpha_fixed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">virialmodel</span> <span class="o">=</span> <span class="s1">&#39;ideal_gas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mf">86.22483806</span><span class="p">,</span> <span class="mf">647.6320968</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_nrtl</span><span class="p">(</span><span class="n">nrtl0</span><span class="p">,</span> <span class="n">mixnrtl</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">alpha_fixed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">virialmodel</span> <span class="o">=</span> <span class="s1">&#39;Abbott&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mf">84.81672981</span><span class="p">,</span> <span class="mf">648.75311712</span><span class="p">]</span>
</pre></div>
</div>
<p>By default the aleatory factor is set to 0.2, this value ca be changed by passing another value to <code class="docutils literal notranslate"><span class="pre">alpha0</span></code> to the fitting function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_nrtl</span><span class="p">(</span><span class="n">nrtl0</span><span class="p">,</span> <span class="n">mixnrtl</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">alpha_fixed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mf">57.38407954</span><span class="p">,</span> <span class="mf">664.29319445</span><span class="p">]</span>
</pre></div>
</div>
<p>If the aleatory factor needs to be optimized it can be included setting alpha_fixed to False, in this case the initial guess has the following form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">A12</span><span class="p">,</span> <span class="n">A21</span><span class="p">,</span> <span class="n">alpha</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initial guess of A12, A21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span>  <span class="mf">650.</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_nrtl</span><span class="p">(</span><span class="n">nrtl0</span><span class="p">,</span> <span class="n">mixnrtl</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">alpha_fixed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values for A12, A21, alpha</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mf">5.53112687e+01</span><span class="p">,</span>  <span class="mf">6.72701992e+02</span><span class="p">,</span>  <span class="mf">3.19740734e-01</span><span class="p">]</span>
</pre></div>
</div>
<p>Temperature dependent parameters can be fitted setting the option Tdep = True in <code class="docutils literal notranslate"><span class="pre">fit_nrtl</span></code>, when this option is used the parameters are computed as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A12 = A12_0 + A12_1  T \\
A21 = A21_0 + A21_1  T\end{split}\]</div>
<p>The initial guess passed to the fit function has the following form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">A12_0</span><span class="p">,</span> <span class="n">A21_0</span><span class="p">,</span> <span class="n">A12_1</span><span class="p">,</span> <span class="n">A21_1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">])</span>
</pre></div>
</div>
<p>or, if alpha fixed is used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nrtl0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">A12_0</span><span class="p">,</span> <span class="n">A21_0</span><span class="p">,</span> <span class="n">A12_1</span><span class="p">,</span> <span class="n">A21_1</span><span class="p">])</span>
</pre></div>
</div>
<span class="target" id="module-0"></span><dl class="py function">
<dt id="phasepy.fit.binaryfit.fit_nrtl">
<code class="sig-name descname">fit_nrtl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">mix</span></em>, <em class="sig-param"><span class="n">datavle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datalle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datavlle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha_fixed</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alpha0</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">Tdep</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">virialmodel</span><span class="o">=</span><span class="default_value">'Tsonopoulos'</span></em>, <em class="sig-param"><span class="n">minimize_options</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phasepy/fit/binaryfit.html#fit_nrtl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#phasepy.fit.binaryfit.fit_nrtl" title="Permalink to this definition">¶</a></dt>
<dd><p>fit_nrtl: attemps to fit nrtl parameters to LVE, LLE, LLVE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>array_like</em>) – initial values interaction parameters (and aleatory factor)</p></li>
<li><p><strong>mix</strong> (<em>object</em>) – binary mixture</p></li>
<li><p><strong>datavle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Yexp, Texp, Pexp)</p></li>
<li><p><strong>datalle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Texp, Pexp)</p></li>
<li><p><strong>datavlle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Yexp, Texp, Pexp)</p></li>
<li><p><strong>alpha_fit</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True fix aleatory factor to the value of alpha0</p></li>
<li><p><strong>alpha0</strong> (<em>float</em>) – value of aleatory factor if fixed</p></li>
<li><p><strong>Tdep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wheter the energy parameters have a temperature dependence</p></li>
<li><p><strong>virialmodel</strong> (<em>function</em>) – function to compute virial coefficients</p></li>
<li><p><strong>minimize_options</strong> (<em>dict</em>) – Dictionary of any additional spefication for scipy minimize</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>if Tdep True parameters are treated as:</dt><dd><p>a12 = a12_1 + a12T * T
a21 = a21_1 + a21T * T</p>
</dd>
<dt>if alpha_fixed False and Tdep True:</dt><dd><p>x0 = [a12, a21, a12T, a21T, alpha]</p>
</dd>
<dt>if alpha_fixed False and Tdep False:</dt><dd><p>x0 = [a12, a21, alpha]</p>
</dd>
<dt>if alpha_fixed True and Tdep False:</dt><dd><p>x0 = [a12, a21]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>fit</strong> – Result of SciPy minimize</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>OptimizeResult</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="fitting-wilson-s-model-parameters">
<h2>Fitting Wilson’s model parameters<a class="headerlink" href="#fitting-wilson-s-model-parameters" title="Permalink to this headline">¶</a></h2>
<p>As an array is been fitted, multidimentional optimization alogirthms are used, the function <code class="docutils literal notranslate"><span class="pre">fit_wilson</span></code> handles this optimization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">phasepy.fit</span> <span class="kn">import</span> <span class="n">fit_wilson</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mixwilson</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initial guess of A12, A21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wilson0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span>  <span class="mf">650.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_wilson</span><span class="p">(</span><span class="n">wilson0</span><span class="p">,</span> <span class="n">mixwilson</span><span class="p">,</span> <span class="n">datavle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mf">163.79243953</span><span class="p">,</span> <span class="mf">497.05518499</span><span class="p">]</span>
</pre></div>
</div>
<p>Tsonopoulos virial correlation is used by default, if desired ideal gas or Abbott correlation can be used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_wilson</span><span class="p">(</span><span class="n">wilson0</span><span class="p">,</span> <span class="n">mixwilson</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">virialmodel</span> <span class="o">=</span> <span class="s1">&#39;ideal_gas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mf">105.42279401</span><span class="p">,</span> <span class="mf">517.2221969</span> <span class="p">]</span>
</pre></div>
</div>
<span class="target" id="module-1"></span><dl class="py function">
<dt id="phasepy.fit.binaryfit.fit_wilson">
<code class="sig-name descname">fit_wilson</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">mix</span></em>, <em class="sig-param"><span class="n">datavle</span></em>, <em class="sig-param"><span class="n">virialmodel</span><span class="o">=</span><span class="default_value">'Tsonopoulos'</span></em>, <em class="sig-param"><span class="n">minimize_options</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phasepy/fit/binaryfit.html#fit_wilson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#phasepy.fit.binaryfit.fit_wilson" title="Permalink to this definition">¶</a></dt>
<dd><p>fit_wilson: attemps to fit wilson parameters to LVE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>array_like</em>) – initial values a12, a21 in K</p></li>
<li><p><strong>mix</strong> (<em>object</em>) – binary mixture</p></li>
<li><p><strong>datavle</strong> (<em>tuple</em>) – (Xexp, Yelv, Texp, Pexp)</p></li>
<li><p><strong>virialmodel</strong> (<em>function</em>) – function to compute virial coefficients</p></li>
<li><p><strong>minimize_options</strong> (<em>dict</em>) – Dictionary of any additional spefication for scipy minimize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fit</strong> – Result of SciPy minimize</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>OptimizeResult</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="fitting-redlich-kister-interaction-parameters">
<h2>Fitting Redlich-Kister interaction parameters<a class="headerlink" href="#fitting-redlich-kister-interaction-parameters" title="Permalink to this headline">¶</a></h2>
<p>As an array is been fitted, multidimentional optimization alogirthms are used, the function <code class="docutils literal notranslate"><span class="pre">fit_rk</span></code> handles this optimization. Redlich-Kister expansion is programmed for n terms of the expansion, this fitting function will optimize considering the lenght of the array passed as an initial guess.</p>
<p>If rk0 is an scalar it reduced to Porter model, if it is array of size 2 it reduces to Margules Model.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">phasepy.fit</span> <span class="kn">import</span> <span class="n">fit_rk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mixrk</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rk0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_rk</span><span class="p">(</span><span class="n">rk0</span><span class="p">,</span> <span class="n">mixrk</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">Tdep</span> <span class="o">=</span>  <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#optimized values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="mf">1.1759649</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.44487888</span><span class="p">]</span>
</pre></div>
</div>
<p>Temperature dependent parameters can be fitted in which case the initial guess will be splitted into two arrays.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rk0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally the parameters are computed as <span class="math notranslate nohighlight">\(G = c + c1/T\)</span>.</p>
<p>Similarly as NRTl and Wilson’s model, virial correlation can be changed by passing the desired function to the <code class="docutils literal notranslate"><span class="pre">virialmodel</span></code> argument.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_rk</span><span class="p">(</span><span class="n">rk0</span><span class="p">,</span> <span class="n">mixrk</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">Tdep</span> <span class="o">=</span>  <span class="kc">False</span><span class="p">,</span> <span class="n">virialmodel</span> <span class="o">=</span> <span class="s1">&#39;ideal_gas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="mf">1.16854714</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43874371</span><span class="p">]</span>
</pre></div>
</div>
<span class="target" id="module-2"></span><dl class="py function">
<dt id="phasepy.fit.binaryfit.fit_rk">
<code class="sig-name descname">fit_rk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inc0</span></em>, <em class="sig-param"><span class="n">mix</span></em>, <em class="sig-param"><span class="n">datavle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datalle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datavlle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Tdep</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">virialmodel</span><span class="o">=</span><span class="default_value">'Tsonopoulos'</span></em>, <em class="sig-param"><span class="n">minimize_options</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phasepy/fit/binaryfit.html#fit_rk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#phasepy.fit.binaryfit.fit_rk" title="Permalink to this definition">¶</a></dt>
<dd><p>fit_rk: attemps to fit RK parameters to LVE, LLE, LLVE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inc0</strong> (<em>array_like</em>) – initial values to RK parameters</p></li>
<li><p><strong>mix</strong> (<em>object</em>) – binary mixture</p></li>
<li><p><strong>datavle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Yexp, Texp, Pexp)</p></li>
<li><p><strong>datalle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Texp, Pexp)</p></li>
<li><p><strong>datavlle</strong> (<em>tuple</em><em>, </em><em>optional</em>) – (Xexp, Wexp, Yexp, Texp, Pexp)</p></li>
<li><p><strong>Tdep</strong> (<em>bool</em><em>,</em>) – wheter the parameter will have a temperature dependence</p></li>
<li><p><strong>virialmodel</strong> (<em>function</em>) – function to compute virial coefficients</p></li>
<li><p><strong>minimize_options</strong> (<em>dict</em>) – Dictionary of any additional spefication for scipy minimize</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>if Tdep true:</dt><dd><p>C = C’ + C’T</p>
</dd>
<dt>if Tdep true:</dt><dd><p>inc0 = [C’0, C’1, C’2, …, C’0T, C’1T, C’2T… ]</p>
</dd>
<dt>if Tdep flase:</dt><dd><p>inc0 = [C0, C1, C2…]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>fit</strong> – Result of SciPy minimize</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>OptimizeResult</p>
</dd>
</dl>
</dd></dl>

<p>Multidimentional minimization in SciPy are perfomed with <code class="docutils literal notranslate"><span class="pre">minimize</span></code> function, aditional command can be passed to this function in order to change tolerance, number of function evaluations or mimization method. This is done by passing a dictionary with the settings to <code class="docutils literal notranslate"><span class="pre">minimize_options</span></code> in <code class="docutils literal notranslate"><span class="pre">fit_nrtl</span></code>, <code class="docutils literal notranslate"><span class="pre">fit_wilson</span></code> or <code class="docutils literal notranslate"><span class="pre">fit_rk</span></code>. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#changing the minimization method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimize_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span> <span class="p">:</span> <span class="s1">&#39;Powell&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_rk</span><span class="p">(</span><span class="n">rk0</span><span class="p">,</span> <span class="n">mixrk</span><span class="p">,</span> <span class="n">datavle</span><span class="p">,</span> <span class="n">Tdep</span> <span class="o">=</span>  <span class="kc">False</span><span class="p">,</span> <span class="n">minimize_options</span> <span class="o">=</span> <span class="n">minimize_options</span> <span class="p">)</span>
</pre></div>
</div>
<p>The fitted parameters can be compared against the equilibrium data for each model. The following figure shows the perfomance of QMR, NRTL model, Wilson model and Redlich Kister expansion.</p>
<img alt="../_images/binaryfit.jpg" src="../_images/binaryfit.jpg" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="fit.pure.html" class="btn btn-neutral float-left" title="Pure component data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Gustavo Chaparro M.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>